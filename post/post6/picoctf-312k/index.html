<!doctype html><html lang=ja><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=HandheldFriendly content="True"><meta http-equiv=x-ua-compatible content="IE=edge"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=generator content="Hugo 0.79.1"><link rel=apple-touch-icon sizes=180x180 href=https://312k.github.io/nekonyaa.github.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://312k.github.io/nekonyaa.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://312k.github.io/nekonyaa.github.io/favicon-16x16.png><link rel=manifest href=https://312k.github.io/nekonyaa.github.io/site.webmanifest><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><title>picoCTF 312k - nekonyaa</title><meta name=author content="312k"><meta name=keywords content="CTF,Writeup,312k"><meta property="og:title" content="picoCTF 312k"><meta name=twitter:title content="picoCTF 312k"><meta property="og:type" content="article"><meta property="og:url" content="https://312k.github.io/nekonyaa.github.io/post/post6/picoctf-312k/"><meta property="og:description" content="はじめに
今回はpicoCTFに参加しました。リバースエンジニアリング、バイナリ問題を中心に考えました。"><meta name=twitter:description content="はじめに
今回はpicoCTFに参加しました。リバースエンジニアリング、バイナリ問題を中心に考えました。"><meta name=twitter:card content="summary"><meta property="article:published_time" content="2021-04-02T17:08:16+09:00"><meta property="article:modified_time" content="2021-04-02T17:08:16+09:00"><style>@media(prefers-color-scheme:dark){body[data-theme=auto] img{filter:brightness(60%)}}body[data-theme=dark] img{filter:brightness(60%)}</style><link rel=stylesheet href=https://312k.github.io/nekonyaa.github.io/assets/css/fuji.min.css><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-186834406-6');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-186834406-6"></script></head><body data-theme=auto><script data-cfasync=false>var fujiThemeData=localStorage.getItem('fuji_data-theme');if(!fujiThemeData){localStorage.setItem('fuji_data-theme','auto');}else{if(fujiThemeData!=='auto'){document.body.setAttribute('data-theme',fujiThemeData==='dark'?'dark':'light');}}</script><header><div class="container-lg clearfix"><div class="col-12 header"><a class=title-main href=https://312k.github.io/nekonyaa.github.io/>nekonyaa</a>
<span class=title-sub>CTFのwrite upなど</span></div></div></header><main><div class="container-lg clearfix"><div class="col-12 col-md-9 float-left content"><article><h2 class="post-item post-title"><a href=https://312k.github.io/nekonyaa.github.io/post/post6/picoctf-312k/>picoCTF 312k</a></h2><div class="post-item post-meta"><span><i class="iconfont icon-today-sharp"></i>&nbsp;2021-04-02</span>
<span><i class="iconfont icon-pricetags-sharp"></i>&nbsp;<a href=https://312k.github.io/nekonyaa.github.io/tags/ctf>CTF</a>&nbsp;<a href=https://312k.github.io/nekonyaa.github.io/tags/writeup>Writeup</a>&nbsp;<a href=https://312k.github.io/nekonyaa.github.io/tags/312k>312k</a>&nbsp;</span></div><div class="post-content markdown-body"><h1 id=はじめに>はじめに</h1><p>今回は<a href=https://picoctf.org/ target=_blank>picoCTF</a>に参加しました。リバースエンジニアリング、バイナリ問題を中心に考えました。</p><h2 id=general-skills>General Skills</h2><h3 id=obedient-cat>Obedient Cat</h3><h4 id=解いた過程>解いた過程</h4><p>この問題はASCIIで書かれたファイルのようです。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ file flag
flag: ASCII text
</code></pre></div><p>ということでstringsコマンドを使って可読文字を表示したいと思います。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ strings flag
picoCTF<span style=color:#f92672>{</span>s4n1ty_v3r1f13d_2fd6ed29<span style=color:#f92672>}</span>
</code></pre></div><h4 id=flag>Flag</h4><p><strong>picoCTF{s4n1ty_v3r1f13d_2fd6ed29}</strong></p><h2 id=wave-a-flag>Wave a flag</h2><h3 id=解いた過程-1>解いた過程</h3><p>問題ファイル拡張子がないのでとりあえずfileコマンドでファイルを確認してみます。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ file warm
warm: ELF 64-bit LSB shared object, x86-64, version <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>SYSV<span style=color:#f92672>)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, <span style=color:#66d9ef>for</span> GNU/Linux 3.2.0, BuildID<span style=color:#f92672>[</span>sha1<span style=color:#f92672>]=</span>01b148cdedfc38125cac0d87e0537466d47927b1, with debug_info, not stripped
</code></pre></div><p>ということでこのファイルはLinuxのELF形式であるとわかりました。
よって実行してみます。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ ./warm
Hello user! Pass me a -h to learn what I can <span style=color:#66d9ef>do</span>!
</code></pre></div><p>helpを表示しろと言われたので表示してみます。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ ./warm -h
Oh, help? I actually don<span style=color:#960050;background-color:#1e0010>&#39;</span>t <span style=color:#66d9ef>do</span> much, but I <span style=color:#66d9ef>do</span> have this flag here: picoCTF<span style=color:#f92672>{</span>b1scu1ts_4nd_gr4vy_f0668f62<span style=color:#f92672>}</span>
</code></pre></div><h3 id=flag-1>Flag</h3><p><strong>picoCTF{b1scu1ts_4nd_gr4vy_f0668f62}</strong></p><h2 id=tab-tab-attack>Tab, Tab, Attack</h2><h3 id=解いた過程-2>解いた過程</h3><p>与えられたファイルは複雑なディレクトリ構造をしています。このようなときには7zipを使うと便利です。
最下層にはELFファイルがありました。
取り出してfileコマンドで確認したところ</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ file fang-of-haynekhtnamet
fang-of-haynekhtnamet: ELF 64-bit LSB shared object, x86-64, version <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>SYSV<span style=color:#f92672>)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, <span style=color:#66d9ef>for</span> GNU/Linux 3.2.0, BuildID<span style=color:#f92672>[</span>sha1<span style=color:#f92672>]=</span>72a56ba85df661b5a985999a435927c01095cccf, not stripped
</code></pre></div><p>ということで実行。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ ./fang-of-haynekhtnamet
*ZAP!* picoCTF<span style=color:#f92672>{</span>l3v3l_up!_t4k3_4_r35t!_2bcfb2ab<span style=color:#f92672>}</span>
</code></pre></div><h3 id=flag-2>Flag</h3><p><strong>picoCTF{l3v3l_up!_t4k3_4_r35t!_2bcfb2ab}</strong></p><h2 id=magikarp-ground-mission>Magikarp Ground Mission</h2><h3 id=解いた過程-3>解いた過程</h3><p>この問題はssh接続してcatとls,~展開をさせる内容でした。
sshで接続したら、</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ ls
1of3.flag.txt  instructions-to-2of3.txt
</code></pre></div><p>ということでFlagぽいファイルを発見しました。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ cat 1of3.flag.txt
picoCTF<span style=color:#f92672>{</span>xxsh_
</code></pre></div><p>何やらここのディレクトリのもう一つのファイルには次のヒントが隠されているようです。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ cat instructions-to-2of3.txt
Next, go to the root of all things, more succinctly <span style=color:#e6db74>`</span>/<span style=color:#e6db74>`</span>
</code></pre></div><p>ルートへ行けと言われました。
ということで最上位ルートディレクトリに移動したいと思います。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ cd /
</code></pre></div><p>同様にしてlsでファイルを確認catで表示</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ cat 2of3.flag.txt
0ut_0f_<span style=color:#ae81ff>\/\/</span>4t3r_
$ cat instructions-to-3of3.txt
Lastly, ctf-player, go home... more succinctly <span style=color:#e6db74>`</span>~<span style=color:#e6db74>`</span>
</code></pre></div><p>ということで~へ行けと言われました。
なお~というのはユーザーのホームディレクトリを示します。
ということで移動します</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ cd ~
$ ls
</code></pre></div><p>同様に</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ cat 3of3.flag.txt
71be5264<span style=color:#f92672>}</span>
</code></pre></div><p>ということでこれらを組み合わせたのがFlagになります。
ただこれだとちょっと手動では面倒なのでつなげてみたいと思います。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ pwd
$ /home/ctf-player
$ cat  drop-in/1of3.flag.txt /2of3.flag.txt 3of3.flag.txt
picoCTF<span style=color:#f92672>{</span>xxsh_0ut_0f_<span style=color:#ae81ff>\/\/</span>4t3r_71be5264<span style=color:#f92672>}</span>
</code></pre></div><h3 id=flag-3>Flag</h3><p>picoCTF{xxsh_0ut_0f_\/\/4t3r_71be5264}</p><h2 id=static-aint-always-noise>Static ain&rsquo;t always noise</h2><h3 id=解いた過程-4>解いた過程</h3><p>この問題はstaticとbashが与えられています。多分この問題はアセンブラ出力された結果を読む問題だと思いましたが、stringsを使って解きました&mldr;</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ strings static |  grep pico
picoCTF<span style=color:#f92672>{</span>d15a5m_t34s3r_6f8c8200<span style=color:#f92672>}</span>
</code></pre></div><h3 id=flag-4>Flag</h3><p><strong>picoCTF{d15a5m_t34s3r_6f8c8200}</strong></p><h2 id=nice-netcat>Nice netcat&mldr;</h2><h3 id=解いた過程-5>解いた過程</h3><p>この問題ncコマンドで接続すると改行されたAsciiが与えられます。
これを変換すると答えになります。</p><h3 id=flag-5>Flag</h3><p><strong>picoCTF{g00d_kitty!_n1c3_kitty!_afd5fda4}</strong></p><p>以上がGeneral Skillsで解いた問題です。
このジャンルはバイナリ系やネットワーク系が多くてよかったです。</p><h1 id=reverse-engineering>Reverse Engineering</h1><h2 id=crackme-py>crackme-py</h2><h3 id=解いた過程-6>解いた過程</h3><p>この問題の13行目にROT47と書いてあります。そのため実際にROT47を使って4行目のシークレットをデコードします。
<a href=https://dencode.com/ja/cipher/rot47 target=_blank>DenCode</a>
こちらのサイトに問題文のエンコードされたものを入力します。</p><h3 id=flag-6>Flag</h3><p><strong>picoCTF{1|/|_4_p34||ut_f3bc410e}</strong></p><h2 id=transformation>Transformation</h2><h3 id=解いた過程-7>解いた過程</h3><p>問題文は何やら文字化けしたような文字が表示されています。</p><blockquote><p>灩捯䍔䙻ㄶ形楴獟楮獴㌴摟潦弸彤㔲挶戹㍽%</p></blockquote><p>ということでとりあえずこの文章を変換してみます。
<a href=http://www.online-decoder.com/bg target=_blank>こちらのサイト</a>ロシア語ですが、結構自動変換してくれて便利です。
自動認識によってFlagが求まりました。</p><h3 id=flag-7>Flag</h3><p><strong>picoCTF{16_bits_inst34d_of_8_d52c6b93}</strong></p><h1 id=終わりに>終わりに</h1><p>デコードをサイトに頼りぱなししてしまったので自分の力だけで解けるように復習しようかなあと思いました。
すごい難しかったけど、次このpicoCTFに出るときに、スラスラと解法が浮かんで解ける人になりたいです。</p></div></article></div><aside class="col-12 col-md-3 float-left sidebar"><div class="sidebar-item sidebar-pages"><h3>ページ</h3><ul><li><a href=https://312k.github.io/nekonyaa.github.io/>Home</a></li><li><a href=https://312k.github.io/nekonyaa.github.io/about>About</a></li><li><a href=https://312k.github.io/nekonyaa.github.io/privacypolicy>PrivacyPolicy</a></li><li><a href=https://312k.github.io/nekonyaa.github.io/result>Result</a></li><li><a href=https://312k.github.io/nekonyaa.github.io/index.xml>RSS</a></li></ul></div><div class="sidebar-item sidebar-links"><h3>リンク</h3><ul><li><a href=https://ctftime.org/team/141534 target=_blank><span>CTFTIME</span></a></li><li><a href=https://github.com/312k/nekonyaa.github.io target=_blank><span>GitHub</span></a></li></ul></div><div class="sidebar-item sidebar-tags"><h3>タグ</h3><div><span><a href=https://312k.github.io/nekonyaa.github.io/tags/312k/>312k</a></span>
<span><a href=https://312k.github.io/nekonyaa.github.io/tags/about/>about</a></span>
<span><a href=https://312k.github.io/nekonyaa.github.io/tags/ctf/>CTF</a></span>
<span><a href=https://312k.github.io/nekonyaa.github.io/tags/mingw/>Mingw</a></span>
<span><a href=https://312k.github.io/nekonyaa.github.io/tags/sr/>sR</a></span>
<span><a href=https://312k.github.io/nekonyaa.github.io/tags/tt6mzn/>tt6mzn</a></span>
<span><a href=https://312k.github.io/nekonyaa.github.io/tags/visual-studio-code/>Visual Studio Code</a></span>
<span><a href=https://312k.github.io/nekonyaa.github.io/tags/writeup/>Writeup</a></span></div></div><div class="sidebar-item sidebar-toc"><h3>目次</h3><nav id=TableOfContents><ul><li><a href=#general-skills>General Skills</a><ul><li><a href=#obedient-cat>Obedient Cat</a></li></ul></li><li><a href=#wave-a-flag>Wave a flag</a><ul><li><a href=#解いた過程-1>解いた過程</a></li><li><a href=#flag-1>Flag</a></li></ul></li><li><a href=#tab-tab-attack>Tab, Tab, Attack</a><ul><li><a href=#解いた過程-2>解いた過程</a></li><li><a href=#flag-2>Flag</a></li></ul></li><li><a href=#magikarp-ground-mission>Magikarp Ground Mission</a><ul><li><a href=#解いた過程-3>解いた過程</a></li><li><a href=#flag-3>Flag</a></li></ul></li><li><a href=#static-aint-always-noise>Static ain&rsquo;t always noise</a><ul><li><a href=#解いた過程-4>解いた過程</a></li><li><a href=#flag-4>Flag</a></li></ul></li><li><a href=#nice-netcat>Nice netcat&mldr;</a><ul><li><a href=#解いた過程-5>解いた過程</a></li><li><a href=#flag-5>Flag</a></li></ul></li></ul><ul><li><a href=#crackme-py>crackme-py</a><ul><li><a href=#解いた過程-6>解いた過程</a></li><li><a href=#flag-6>Flag</a></li></ul></li><li><a href=#transformation>Transformation</a><ul><li><a href=#解いた過程-7>解いた過程</a></li><li><a href=#flag-7>Flag</a></li></ul></li></ul></nav></div></aside></div><div class=btn><div class=btn-menu id=btn-menu><i class="iconfont icon-grid-sharp"></i></div><div class=btn-toggle-mode><i class="iconfont icon-contrast-sharp"></i></div><div class=btn-scroll-top><i class="iconfont icon-chevron-up-circle-sharp"></i></div></div><aside class=sidebar-mobile style=display:none><div class=sidebar-wrapper><div class="sidebar-item sidebar-pages"><h3>ページ</h3><ul><li><a href=https://312k.github.io/nekonyaa.github.io/>Home</a></li><li><a href=https://312k.github.io/nekonyaa.github.io/about>About</a></li><li><a href=https://312k.github.io/nekonyaa.github.io/privacypolicy>PrivacyPolicy</a></li><li><a href=https://312k.github.io/nekonyaa.github.io/result>Result</a></li><li><a href=https://312k.github.io/nekonyaa.github.io/index.xml>RSS</a></li></ul></div><div class="sidebar-item sidebar-links"><h3>リンク</h3><ul><li><a href=https://ctftime.org/team/141534 target=_blank><span>CTFTIME</span></a></li><li><a href=https://github.com/312k/nekonyaa.github.io target=_blank><span>GitHub</span></a></li></ul></div><div class="sidebar-item sidebar-tags"><h3>タグ</h3><div><span><a href=https://312k.github.io/nekonyaa.github.io/tags/312k/>312k</a></span>
<span><a href=https://312k.github.io/nekonyaa.github.io/tags/about/>about</a></span>
<span><a href=https://312k.github.io/nekonyaa.github.io/tags/ctf/>CTF</a></span>
<span><a href=https://312k.github.io/nekonyaa.github.io/tags/mingw/>Mingw</a></span>
<span><a href=https://312k.github.io/nekonyaa.github.io/tags/sr/>sR</a></span>
<span><a href=https://312k.github.io/nekonyaa.github.io/tags/tt6mzn/>tt6mzn</a></span>
<span><a href=https://312k.github.io/nekonyaa.github.io/tags/visual-studio-code/>Visual Studio Code</a></span>
<span><a href=https://312k.github.io/nekonyaa.github.io/tags/writeup/>Writeup</a></span></div></div></div></aside></main><footer><div class="container-lg clearfix"><div class="col-12 footer"><span>&copy; 2021
<a href=https://312k.github.io/nekonyaa.github.io/>nekonyaa</a>
| <a href=https://github.com/312k/nekonyaa.github.io>Source code</a>
| Powered by <a href=https://github.com/dsrkafuu/hugo-theme-fuji/ target=_blank>Fuji-v2</a> & <a href=https://gohugo.io/ target=_blank>Hugo</a></span></div></div></footer><script defer src=https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.0/lazysizes.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-core.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js></script><script defer src=https://312k.github.io/nekonyaa.github.io/assets/js/fuji.min.js></script></body></html>